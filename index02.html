
<!--<!DOCTYPE html>-->
<html lang="ja">

<head>

	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="test.css" >
	<link rel="icon" type="image/png" href="./img/favicon.png">
	<script src="script/openseadragon.js"></script>
	<title>2434map</title>


<style type="text/css">



#_TOP2{
	margin:10px;
	width:15000px;/*ここを固定長にしないとブラウザの横幅に従って変形する*/
	float:left;
	/*border:1px solid blue;テスト用*/
}
#_TOP2 img {/*こう書けば_TOP以下の全部のimgに反映される*/
	margin:0;/*img毎、隣との隙間をなくす*/
	float:left;/*左上から積み下げていく*/
	/*vertical-align: middle;*/
}



.relative {
    position: relative; /*relative*/
	width: 15000px;
	height: 12000px;
}



/*
.site-header{
    position: fixed;
}
*/


/*中央拠点*/
.Center {
    position: absolute;
	right: 2000px;
	bottom: -8500px;
}


/*井戸先*/
.well {
    position: absolute; /*absolute*/
	right: 13000px;
	bottom: -2800px;
}


/*openseadragonの地図をクリック拡大すると上部タブが消えるための対応*/
.osd_disp{
	height: 96%;
}

/*タブ部分*/
.navi {
    height: 20px;
    position: fixed;
    z-index: 999;
}

#a1 {
	position: absolute;
}
#a2 {
	position: absolute;
}

.map-marker{
 /* transform: translate(-50%, -100%);	一旦削除 */
  text-align: center;
  font-size: 6px; /* 文字サイズを調整 */
}
.map-marker img {
    width: 24px; /* アイコンの大きさ */
}
.marker-icon{
  width: 32px;
}

.marker-label{
  font-size: 12px;
  background: white;
  padding: 2px 6px;
  border-radius: 6px;
  border: 1px solid #333;
  margin-top: 2px;
  white-space: nowrap;
}

</style>
</head>


<body>
<a name="wrap"></a>
<div class="cp_tab">
	
	<input type="radio" name="cp_tab" id="tab1_1" aria-controls="normal_tab01" checked>
	<label for="tab1_1">通常地図</label>

	<input type="radio" name="cp_tab" id="tab1_2" aria-controls="all_tab01">
	<label for="tab1_2">全体地図</label>

	<input type="radio" name="cp_tab" id="tab1_3" aria-controls="nether_tab01">
	<label for="tab1_3">ネザー地図</label>

	<input type="radio" name="cp_tab" id="tab1_4" aria-controls="land_tab01">
	<label for="tab1_4">にじさんじランド</label>

	<input type="radio" name="cp_tab" id="tab1_5" aria-controls="newworld_tab01">
	<label for="tab1_5">新鯖通常地図</label>


	<input type="radio" name="cp_tab" id="tab1_6" aria-controls="newworld_all_tab01">
	<label for="tab1_6">新鯖全体地図</label>


	<input type="radio" name="cp_tab" id="tab1_7" aria-controls="newworld_nether_tab01">
	<label for="tab1_7">新鯖ネザー</label>

	<input type="radio" name="cp_tab" id="tab1_8" aria-controls="sakura_tab01">
	<label for="tab1_8">桜ンボ村</label>
		
	<input type="radio" name="cp_tab" id="tab1_9" aria-controls="ark_tab01">
	<label for="tab1_9">夏祭り会場2023</label>
<!--
	<input type="radio" name="cp_tab" id="tab1_10" aria-controls="member_tab01">
	<label for="tab1_10">ライバー参考</label>
-->
<!--
	<input type="radio" name="cp_tab" id="tab1_11" aria-controls="etc_tab01">
	<label for="tab1_11">他(連絡先等)</label>
-->
<!--
	<input type="radio" name="cp_tab" id="tab1_12" aria-controls="ex_tab01">
	<label for="tab1_12">試験運用</label>
-->
<div class="cp_tabpanels">





<!--通常地図タブ-->
<div id="normal_tab01" class="cp_tabpanel">
	<div id="contentDiv_main" class="osd_disp"></div>
	<script type="text/javascript">

		var viewer_2434map_main = OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_main",
			prefixUrl:       "2434map_files/",
			tileSources:     "2434map.xml"
		});
		viewer_2434map_main.addHandler('open', function(){
		   loadMarkers(viewer_2434map_main, "2434map_marker.csv");
		});
	</script>
</div>





<!--全体地図タブ-->
<div id="all_tab01" class="cp_tabpanel">
	<div id="contentDiv_all" class="osd_disp"></div>
	<script type="text/javascript">
		var viewer_2434map_all = OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_all",
			prefixUrl:       "2434map_all_files/",
			tileSources:     "2434map_all.xml"
		});
		viewer_2434map_all.addHandler('open', function(){
		   loadMarkers(viewer_2434map_all, "2434map_all_marker.csv");
		});
	</script>
</div>



<!-- 全体地図の旧ファイル分割式
<div id="all_tab01" class="cp_tabpanel">
	
	<div class="navi">
		<a href="#wrap" class="btn-flat-vertical-border">メニューへ</a>
		<a href="#a1" class="btn-flat-vertical-border">中央拠点へ</a>
		<a href="#a2" class="btn-flat-vertical-border">井戸の先へ</a>
	</div>

	<div class="relative">
		<div id="a1" class="Center"></div>
		<div id="a2" class="well"></div>
	</div>

		<div id="_TOP2">
			<img src="img/all-a01.png"><img src="img/all-a02.png"><img src="img/all-a03.png"><img src="img/all-a04.png"><img src="img/all-a05.png">
			<img src="img/all-b01.png"><img src="img/all-b02.png"><img src="img/all-b03.png"><img src="img/all-b04.png"><img src="img/all-b05.png">
			<img src="img/all-c01.png"><img src="img/all-c02.png"><img src="img/all-c03.png"><img src="img/all-c04.png"><img src="img/all-c05.png">
			<img src="img/all-d01.png"><img src="img/all-d02.png"><img src="img/all-d03.png"><img src="img/all-d04.png"><img src="img/all-d05.png">
		</div>
</div>
-->




<!--ネザー地図タブ-->
<div id="nether_tab01" class="cp_tabpanel">
	<div id="contentDiv_nether" class="osd_disp"></div>
	<script type="text/javascript">
		var viewer_2434map_nether = OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_nether",
			prefixUrl:       "2434map_nether_files/",
			tileSources:     "2434map_nether.xml"
		});
		viewer_2434map_nether.addHandler('open', function(){
		   loadMarkers(viewer_2434map_nether, "2434map_nether_marker.csv");
		});
	</script>
</div>


<!--にじさんじランドタブ-->
<div id="land_tab01" class="cp_tabpanel">
	<p id="PageTopBtn"><a href="#wrap">▲</a></p>
	<img src="img/2434map_land.png">
</div>


<!--新規開拓ワールドタブ-->
<div id="newworld_tab01" class="cp_tabpanel">
	<div id="contentDiv_new" class="osd_disp"></div>
	<script type="text/javascript">
		var viewer_2434map_new = OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_new",
			prefixUrl:       "2434map_new_files/",
			tileSources:     "2434map_new.xml"
		});
		viewer_2434map_new.addHandler('open', function(){
		   loadMarkers(viewer_2434map_new, "2434map_new_marker.csv");
		});
	</script>
</div>




<!--新規開拓ワールド全体タブ-->
<div id="newworld_all_tab01" class="cp_tabpanel">
	<div id="contentDiv_new_all" class="osd_disp"></div>
	<script type="text/javascript">
		var viewer_2434map_new_all = OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_new_all",
			prefixUrl:       "2434map_new_all_files/",
			tileSources:     "2434map_new_all.xml"
		});
		viewer_2434map_new_all.addHandler('open', function(){
		   loadMarkers(viewer_2434map_new_all, "2434map_new_all_marker.csv");
		});
	</script>
</div>




<!--新規開拓ワールドネザータブ-->
<div id="newworld_nether_tab01" class="cp_tabpanel">
	<div id="contentDiv_new_nether" class="osd_disp"></div>
	<script type="text/javascript">
		var viewer_2434map_new_nether = OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_new_nether",
			prefixUrl:       "2434map_new_nether_files/",
			tileSources:     "2434map_new_nether.xml"
		});
		viewer_2434map_new_nether.addHandler('open', function(){
		   loadMarkers(viewer_2434map_new_nether, "2434map_new_nether_marker.csv");
		});
	</script>
</div>


<!--桜ンボ村タブ-->
<div id="sakura_tab01" class="cp_tabpanel">
	<p id="PageTopBtn"><a href="#wrap">▲</a></p>
	<img src="img/2434map_nbo.png">
</div>


<!--お祭り会場2023タブ-->
<div id="ark_tab01" class="cp_tabpanel">
	<div id="contentDiv_ark" class="osd_disp"></div>
	<script type="text/javascript">
		var viewer_omatsuri2023 = OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_omatsuri2023",
			prefixUrl:       "omatsuri2023_files/",
			tileSources:     "omatsuri2023.xml"
		});
		viewer_omatsuri2023.addHandler('open', function(){
		   loadMarkers(viewer_omatsuri2023, "omatsuri2023_marker.csv");
		});
	</script>
</div>


<script>
// マーカー設置追加関数
function addMarker(viewer, imageX, imageY, text, icon, spriteX, spriteY){

  const viewportPoint =
    viewer.viewport.imageToViewportCoordinates(imageX, imageY);

  const el = document.createElement("div");
  el.className = "map-marker";

  // 1セルのサイズ
  const cellSize = 44; // 176/16

  el.innerHTML = `
    <div class="marker-icon-sprite"
         style="
           width:${cellSize}px;
           height:${cellSize}px;
           background-image:url(${icon});
           background-position:-${cellSize*(spriteX-1)}px -${cellSize*(spriteY-1)}px;
           background-size:176px 176px;
	   margin:0;
         ">
    </div>
    <div style="margin:0; line-height:1; font-size:6px;">${text}</div>`;

  // OpenSeadragon でズームに追従させる
  viewer.addOverlay({
    element: el,
     location: viewer.viewport.imageToViewportCoordinates(imageX, imageY),
    placement: "CENTER"  // 中心に合わせる
  });
}

// ▼ CSV読み込み
function loadMarkers(viewer, csvFile){

  fetch(csvFile)
    .then(res => res.text())
    .then(text => {

      const rows = text.split("\n").slice(1);

      rows.forEach(row => {
        const [x,z,label,icon,spriteX,spriteY] = row.split(",");

        addMarker(viewer,
          parseFloat(x),
          parseFloat(z),// Zを画像Y座標として扱う
          label,
          icon,
          parseInt(spriteX),
          parseInt(spriteY)
        );
      });
    });
}
</script>


<!--ライバー参考タブ
<div id="member_tab01" class="cp_tabpanel">
		<img src="img/2434member.png"><br><br>
		<img src="img/2434birthday.png">
</div>
-->

<!--他(連絡先)タブ-->
<div id="etc_tab01" class="cp_tabpanel">
		<br>
2434map 1	にじさんじサーバーまとめ/名所 > 地図画像下の<a href="https://2434map.github.io/1/">[地図ブラウズ]</a>リンクから　更新2019年頃まで。<br>
2434map 2	にじさんじサーバーまとめ <a href="https://cyokin.cloudfree.jp/2434map.html">地図画像リンク</a>から 更新2022年9月頃まで。<br>
</div>


<!--試験運用タブ-->

<!--
<div id="ex_tab01" class="cp_tabpanel">
	<div id="contentDiv_ex" class="osd_disp"></div>
	<script type="text/javascript">
		OpenSeadragon({
			showNavigator: true,
			id:              "contentDiv_ex",
			prefixUrl:       "2434map_all_files/",
			tileSources:     "2434map_all.xml"
		});
	</script>
</div>
-->

</body>

</html>